<!-- Skip Link para Accesibilidad -->
<a href="#main-content" class="skip-link">Saltar al contenido principal</a>

<!-- Menu de Navegación -->
<header class="header" role="banner">
  <div class="container">
    <nav class="navbar" role="navigation" aria-label="Navegación principal">
      <div class="logo">
        <a href="https://mantenimientodeextintores.mx/" aria-label="MANEXT - Ir al inicio">
          <img src="https://mantenimientodeextintores.mx/img/img-index/venta-y-mantenimiento-de-extintores.avif" alt="MANEXT - Mantenimiento de Extintores" class="logo-img" width="220" height="110">
        </a>
      </div>

      <button
        class="menu-toggle"
        aria-label="Abrir menú de navegación"
        aria-expanded="false"
        aria-controls="navMenu"
        id="menuToggle"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>

      <div class="menu-overlay" id="menuOverlay" aria-hidden="true"></div>

      <ul class="nav-menu" id="navMenu" role="menubar">
        <li class="dropdown" role="none">
          <a href="https://mantenimientodeextintores.mx/servicios.html" class="nav-link dropdown-toggle" role="menuitem" aria-haspopup="true" aria-expanded="false">Servicios <span class="arrow" aria-hidden="true">▼</span></a>
          <ul class="dropdown-menu" role="menu" aria-label="Submenú de Servicios">
            <li role="none"><a href="https://mantenimientodeextintores.mx/venta-de-extintores.html" role="menuitem">Venta de Extintores</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/mantenimiento-preventivo.html" role="menuitem">Mantenimiento Preventivo</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/recarga-de-extintores.html" role="menuitem">Recarga de Extintores</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/prueba-hidrostatica.html" role="menuitem">Prueba Hidrostática</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/capacitacion-brigadas.html" role="menuitem">Capacitación y Brigadas</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/senalizacion.html" role="menuitem">Señalización</a></li>
          </ul>
        </li>
        <li role="none"><a href="https://mantenimientodeextintores.mx/extintores.html" class="nav-link" role="menuitem">Extintores</a></li>
        <li class="dropdown" role="none">
          <a href="https://mantenimientodeextintores.mx/catalogo.html" class="nav-link dropdown-toggle" role="menuitem" aria-haspopup="true" aria-expanded="false">Catálogo <span class="arrow" aria-hidden="true">▼</span></a>
          <ul class="dropdown-menu" role="menu" aria-label="Submenú de Catálogo">
            <li role="none"><a href="https://mantenimientodeextintores.mx/catalogo.html" role="menuitem"><strong>Ver Catálogo Completo</strong></a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/polvo-quimico-seco.html" role="menuitem">Polvo Químico Seco (PQS)</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/co2.html" role="menuitem">Dióxido de Carbono (CO2)</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/agua-presion.html" role="menuitem">Agua a Presión</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/tipo-k.html" role="menuitem">Agente Húmedo (Tipo K)</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/espuma-afff.html" role="menuitem">Espuma (AFFF)</a></li>
            <li role="none"><a href="https://mantenimientodeextintores.mx/agentes-limpios.html" role="menuitem">Agentes Limpios</a></li>
          </ul>
        </li>
        <li role="none"><a href="https://mantenimientodeextintores.mx/nosotros.html" class="nav-link" role="menuitem">Nosotros</a></li>
        <li role="none"><a href="https://mantenimientodeextintores.mx/blog/" class="nav-link" role="menuitem">Blog</a></li>
        <li role="none"><a href="https://mantenimientodeextintores.mx/contacto.html" class="nav-link" role="menuitem">Contacto</a></li>
        <li role="none"><a href="tel:5539689272" class="nav-link nav-phone" role="menuitem" aria-label="Llamar al 55 3968 9272">55 3968 9272</a></li>
      </ul>
    </nav>
  </div>
</header>

<script>
(function() {
  'use strict';

  const menuToggle = document.getElementById('menuToggle');
  const navMenu = document.getElementById('navMenu');
  const menuOverlay = document.getElementById('menuOverlay');
  const body = document.body;
  const dropdowns = document.querySelectorAll('.dropdown');
  const dropdownToggles = document.querySelectorAll('.dropdown-toggle');

  if (!menuToggle || !navMenu || !menuOverlay) return;

  // Función para abrir el menú
  function openMenu() {
    navMenu.classList.add('active');
    menuToggle.classList.add('active');
    menuOverlay.classList.add('active');
    body.classList.add('menu-open');
    menuToggle.setAttribute('aria-expanded', 'true');
    menuToggle.setAttribute('aria-label', 'Cerrar menú de navegación');
    menuOverlay.setAttribute('aria-hidden', 'false');
  }

  // Función para cerrar el menú
  function closeMenu() {
    navMenu.classList.remove('active');
    menuToggle.classList.remove('active');
    menuOverlay.classList.remove('active');
    body.classList.remove('menu-open');
    menuToggle.setAttribute('aria-expanded', 'false');
    menuToggle.setAttribute('aria-label', 'Abrir menú de navegación');
    menuOverlay.setAttribute('aria-hidden', 'true');

    // Cerrar todos los dropdowns
    dropdowns.forEach(function(dropdown) {
      dropdown.classList.remove('active');
      const toggle = dropdown.querySelector('.dropdown-toggle');
      if (toggle) toggle.setAttribute('aria-expanded', 'false');
    });
  }

  // Toggle del menú al hacer clic en el botón hamburguesa
  menuToggle.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();

    if (navMenu.classList.contains('active')) {
      closeMenu();
    } else {
      openMenu();
    }
  });

  // Cerrar menú al hacer clic en el overlay
  menuOverlay.addEventListener('click', function() {
    closeMenu();
  });

  // Manejo de dropdowns con accesibilidad
  dropdowns.forEach(function(dropdown) {
    const dropdownToggle = dropdown.querySelector('.dropdown-toggle');

    if (dropdownToggle) {
      dropdownToggle.addEventListener('click', function(e) {
        // En móvil, evitar navegación y toggle dropdown
        if (window.innerWidth <= 768) {
          e.preventDefault();
          e.stopPropagation();

          const isActive = dropdown.classList.contains('active');

          // Cerrar todos los otros dropdowns
          dropdowns.forEach(function(otherDropdown) {
            if (otherDropdown !== dropdown) {
              otherDropdown.classList.remove('active');
              const otherToggle = otherDropdown.querySelector('.dropdown-toggle');
              if (otherToggle) otherToggle.setAttribute('aria-expanded', 'false');
            }
          });

          // Toggle el dropdown actual
          if (isActive) {
            dropdown.classList.remove('active');
            dropdownToggle.setAttribute('aria-expanded', 'false');
          } else {
            dropdown.classList.add('active');
            dropdownToggle.setAttribute('aria-expanded', 'true');
          }
        }
      });

      // Soporte de teclado para dropdowns
      dropdownToggle.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          dropdownToggle.click();
        }
      });
    }
  });

  // Cerrar menú al hacer clic en enlaces (excepto dropdown toggles)
  const navLinks = navMenu.querySelectorAll('.nav-link:not(.dropdown-toggle)');
  navLinks.forEach(function(link) {
    link.addEventListener('click', function() {
      closeMenu();
    });
  });

  // Cerrar dropdowns al hacer clic en sus enlaces
  const dropdownLinks = navMenu.querySelectorAll('.dropdown-menu a');
  dropdownLinks.forEach(function(link) {
    link.addEventListener('click', function() {
      closeMenu();
    });
  });

  // Prevenir cierre al hacer clic dentro del menú
  navMenu.addEventListener('click', function(e) {
    e.stopPropagation();
  });

  // Cerrar menú con tecla Escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && navMenu.classList.contains('active')) {
      closeMenu();
      menuToggle.focus();
    }
  });

  // Cerrar menú al cambiar de tamaño de ventana (de móvil a desktop)
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      if (window.innerWidth > 768 && navMenu.classList.contains('active')) {
        closeMenu();
      }
    }, 250);
  });
  // Marcar enlace activo con aria-current="page"
  const currentPath = window.location.pathname;
  const navLinks = document.querySelectorAll('.nav-menu a');

  navLinks.forEach(function(link) {
    const linkPath = new URL(link.href).pathname;
    if (currentPath === linkPath ||
        (currentPath.endsWith('/') && linkPath === '/index.html') ||
        (currentPath === '/' && linkPath === '/index.html')) {
      link.setAttribute('aria-current', 'page');
      link.classList.add('active');
    }
  });
})();
</script>
